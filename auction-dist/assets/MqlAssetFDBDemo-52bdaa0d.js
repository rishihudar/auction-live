import{ai as e,am as t,an as a,_ as s,d as l,r as n,o as d,e as o,b as i,f as r,a as u,u as m,i as h,t as c,k as p}from"./index-4336d1e5.js";const g=window.app;class L{constructor(s=null){let l,n=e.CancelToken;this.assetData=new FormData,this.route="assetfdb",this.downloadRoute="assetdownload",this.hostName="",this.fileName="",this.indexType="o",this.indexId=s,this.recordId="";this.customURL="",this.mainStore=t();const d=e.create({baseURL:g.getBaseURL(),managementURL:g.getManagementURL()});d.interceptors.request.use((function(e){return-1===e.url.indexOf("r/mql")&&-1===e.url.indexOf("r/c/mql")||null===sessionStorage.getItem("user-token")&&l("Operation canceled by the MQL interceptor."),e}),(function(e){return Promise.reject(e)}));const o=(e={})=>(e.Authorization="Bearer "+sessionStorage.getItem("user-token"),e["Content-Type"]="multipart/form-data",e);this.formatIndex=function(e){this.indexType=e.split(".")[0],this.indexId=e.split(".")[1]},this.generateUploadURL=()=>{let e=`${this.indexType}/${this.route}/${this.hostName}/${this.indexId}`;return e=this.customURL?`${this.customURL}/${e}`:`/${e}`,e},this.generateUpdateURL=()=>{let e=`${this.indexType}/${this.route}/${this.hostName}/${this.indexId}`;return this.recordId?(e=`${e}/${this.recordId}`,this.customURL?(e=`${this.customURL}/${e}`,e):(e=`/${e}`,e)):(e=`${e}/`,e)},this.generateStreamURL=e=>{let t=`${this.indexType}/${this.route}`;if(e)return t=`${t}/${e}`,this.customURL?(t=`${this.customURL}/${t}`,t):(t=`/server/${t}`,t);console.error("Asset Path cannot be null")},this.generateDownloadURL=e=>{let t=`${this.indexType}/${this.downloadRoute}`;if(e)return t=`${t}/${e}`,this.customURL?(t=`${this.customURL}/${t}`,t):(t=`/server/${t}`,t);console.error("Asset Path cannot be null")},this.setIndex=function(e){return this.formatIndex(e),this},this.setHostName=function(e){return this.hostName=e,this},this.setFormData=e=>(this.fileName=e.get("file").name,this.assetData.append("asset",e.get("file")),this),this.setCustomURL=e=>(this.customURL=e,this),this.setAssetData=function(e){return e=JSON.stringify(e),this.assetData.set("data",e),this},this.enablePageLoader=function(e=!1){return this.showPageLoader=e,this},this.setUpdateWithRecordId=function(e){return this.recordId=e,this},this.uploadAssetFile=(e=null)=>{let t="";return this.showPageLoader&&this.mainStore.MUTATE_PAGE_BLOCKER(!0),new Promise((s=>{null!==e&&null!==document.getElementById(e)&&(t=document.getElementById(e).innerHTML,document.getElementById(e).disabled=!0,document.getElementById(e).innerHTML="Processing");let i="";if(i=this.recordId?this.generateUpdateURL():this.generateUploadURL(),this.indexId)d({url:i,method:"POST",headers:o(),data:this.assetData,cancelToken:new n((function(e){l=e}))}).then((l=>{this.showPageLoader&&this.mainStore.MUTATE_PAGE_BLOCKER(!0),null!==e&&null!==document.getElementById(e)&&(document.getElementById(e).disabled=!1,document.getElementById(e).innerHTML=t);let n={data:{}};n.data.errorCode=1e3,n.data.result=l.data,s(new a(n))})).catch((l=>{let n={data:{}};null!==e&&null!==document.getElementById(e)&&(document.getElementById(e).disabled=!1,document.getElementById(e).innerHTML=t),this.showPageLoader&&this.mainStore.MUTATE_PAGE_BLOCKER(!1),n.data.error=l.message,n.data.errorCode=1990,n.data.result=null,s(new a(n))}));else{null!==e&&null!==document.getElementById(e)&&(document.getElementById(e).disabled=!1,document.getElementById(e).innerHTML=t);let l={data:{}};l.data.error="Data Not Found"+this.assetData,l.data.errorCode=1990,l.data.result=null,s(new a(l))}})).catch((e=>{alert(e)}))},this.download=(e,t=null)=>{let s="";return this.showPageLoader&&this.mainStore.MUTATE_PAGE_BLOCKER(!0),new Promise((l=>{if(null!==t&&null!==document.getElementById(t)&&(s=document.getElementById(t).innerHTML,document.getElementById(t).disabled=!0,document.getElementById(t).innerHTML="Processing"),e)window.open(this.generateDownloadURL(e),"_blank");else{null!==t&&null!==document.getElementById(t)&&(document.getElementById(t).disabled=!1,document.getElementById(t).innerHTML=s);let e={data:{}};e.data.error="No Data Found"+this.assetData,e.data.errorCode=1990,e.data.result=null,l(new a(e))}})).catch((e=>{alert(e)}))},this.render=(e,t=null)=>{let s="";return this.showPageLoader&&this.mainStore.MUTATE_PAGE_BLOCKER(!0),new Promise((l=>{if(null!==t&&null!==document.getElementById(t)&&(s=document.getElementById(t).innerHTML,document.getElementById(t).disabled=!0,document.getElementById(t).innerHTML="Processing"),e)window.open(this.generateStreamURL(e),"_blank");else{null!==t&&null!==document.getElementById(t)&&(document.getElementById(t).disabled=!1,document.getElementById(t).innerHTML=s);let e={data:{}};e.data.error="No Data Found"+this.assetData,e.data.errorCode=1990,e.data.result=null,l(new a(e))}})).catch((e=>{alert(e)}))}}}const f={id:"assetFDB"},I={class:"text-xl font-bold flex gap-2 items-center"},y={class:"box-login mx-auto p-8 max-w-2xl rounded-xl bg-white shadow"},E=i("h3",null,"Upload File",-1),w={class:"field mt-5"},b={class:"field mt-5"},B=i("h3",{class:"mb-5"},"Asset File",-1),U={class:"field mt-5"},x=i("h3",{class:"mb-5"},"Update File",-1),T={class:"field mt-5"},R={class:"field mt-5"},v=i("h3",{class:"mb-3"},"Updated Asset Path",-1),$={key:0},A={key:1},P=s({__name:"MqlAssetFDBDemo",setup(e){let t=l(""),a=l("");l("");let s=l(""),g=l("");l("isax isax-bold-cloud-plus"),l("isax isax-bold-add"),l("isax isax-bold-close-circle");let P=l(""),D=l("");function F(){let e=new FormData;e.append("file",a.value),(new L).enablePageLoader(!0).setIndex("o.9929b6e44da568f390d20e51032b").setHostName("TestMixedBucketFDB2").setFormData(e).setAssetData({TestAssetBucket:"bucket1"}).uploadAssetFile().then((e=>{e.isValid()?t.value=e.getAssetPath():e.showErrorToast()}))}function M(){(new L).download(g.value||t.value)}function C(){(new L).render(g.value||t.value)}return(e,a)=>{const l=n("FormKit");return d(),o("div",f,[i("h2",I,[i("i",{class:"isax isax-bold-arrow-left-2 cursor-pointer",onClick:a[0]||(a[0]=t=>e.$router.go(-1))}),r(" MQL Request For Asset FDB ")]),i("div",y,[E,i("div",w,[u(l,{type:"file",label:"Your files",help:"This input starts with files already attached.",multiple:"true",value:m(P),modelValue:m(D),"onUpdate:modelValue":a[1]||(a[1]=e=>h(D)?D.value=e:D=e)},null,8,["value","modelValue"]),u(l,{type:"submit",label:"Upload File",onClick:F})]),i("div",b,[B,u(l,{type:"text",name:"assetPath",label:"assetPath",modelValue:m(t),"onUpdate:modelValue":a[2]||(a[2]=e=>h(t)?t.value=e:t=e),placeholder:"Enter Asset File Path",help:"Asset File Path",validation:"required"},null,8,["modelValue"])]),i("div",U,[x,u(l,{type:"text",name:"recordId",label:"recordId",modelValue:m(s),"onUpdate:modelValue":a[3]||(a[3]=e=>h(s)?s.value=e:s=e),placeholder:"Enter recordId",help:"Record Id",validation:"required"},null,8,["modelValue"])]),i("div",T,[u(l,{type:"file",label:"Your files",help:"This input starts with files already attached.",multiple:"true",value:m(P),modelValue:m(D),"onUpdate:modelValue":a[4]||(a[4]=e=>h(D)?D.value=e:D=e)},null,8,["value","modelValue"])]),i("div",R,[v,m(g)?(d(),o("p",A,c(m(g)),1)):(d(),o("p",$,"Asset path not updated"))]),u(l,{type:"submit",onClick:p(M,["stop","prevent"]),label:"Download Asset"}),u(l,{type:"submit",onClick:p(C,["stop","prevent"]),label:"Render Asset"})])])}}},[["__file","D:/acution-live/auction-server/auction-live/src/views/MqlAssetFDBDemo.vue"]]);export{P as default};
//# sourceMappingURL=MqlAssetFDBDemo-52bdaa0d.js.map
